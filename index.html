<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Detecci√≥n de Razas de Perros</title>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
<style>
body { font-family: Arial; text-align: center; margin: 40px; }
#preview { width: 200px; height: 200px; object-fit: cover; border: 1px solid #ccc; margin-top: 10px; }
#resultado { font-size: 1.5rem; margin-top: 20px; font-weight: bold; }
</style>
</head>
<body>

<h1>Clasificador de Razas de Perros üêï</h1>
<p>Sube una foto de un perro y el modelo intentar√° adivinar la raza</p>

<input type="file" id="file-input" accept="image/*" onchange="cargarImagen(event)">
<br>
<img id="preview" src="" alt="Previsualizaci√≥n">
<div id="resultado">Esperando imagen...</div>

<script>
let modelo = null;
let nombresClases = [
  "Abyssinian", "American_bulldog", "Beagle", "Boxer", "Chihuahua",
  "German_shepherd", "Golden_retriever", "Pitbull", "Rottweiler"
  // ‚Üê Aqu√≠ pones las clases que usaste en tu modelo
];

async function cargarModelo() {
  document.getElementById('resultado').innerText = "Cargando modelo...";
  modelo = await tf.loadLayersModel("model.json");
  document.getElementById('resultado').innerText = "Modelo cargado. Sube una imagen.";
  console.log("Modelo cargado.");
}
cargarModelo();

function cargarImagen(event) {
  const imgElement = document.getElementById('preview');
  imgElement.src = URL.createObjectURL(event.target.files[0]);
  imgElement.onload = predecir;
}

async function predecir() {
  if (!modelo) return;

  let img = document.getElementById('preview');
  let tensor = tf.browser.fromPixels(img)
                .resizeNearestNeighbor([160,160])
                .toFloat()
                .div(255.0)
                .expandDims();

  let prediccion = modelo.predict(tensor);
  let valores = await prediccion.data();
  let indice = valores.indexOf(Math.max(...valores));

  document.getElementById('resultado').innerText =
    "Predicci√≥n: " + nombresClases[indice];
}
</script>

</body>
</html>
